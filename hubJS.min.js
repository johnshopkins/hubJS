Array.prototype.map||(Array.prototype.map=function(e,t){var n,r,i;if(this==null)throw new TypeError(" this is null or not defined");var s=Object(this),o=s.length>>>0;if(typeof e!="function")throw new TypeError(e+" is not a function");t&&(n=t);r=new Array(o);i=0;while(i<o){var u,a;if(i in s){u=s[i];a=e.call(n,u,i,s);r[i]=a}i++}return r});var Deferred=function(){var e={newDefer:{},resolve:function(t,n,r){var i=e.fulfilled(t,n,r);i&&i.then?i.then(function(t){e.newDefer.resolve(t)}):typeof e.newDefer.resolve=="function"&&e.newDefer.resolve(i)},reject:function(t){var n=e.error(t);t&&t.then?t.then(function(t){e.newDefer.resolve(t)}):typeof e.newDefer.reject=="function"&&e.newDefer.reject(n)},fulfilled:function(e,t,n){},error:function(e,t){},progress:function(){},promise:{then:function(t,n,r){e.fulfilled=typeof t=="function"?t:function(){};e.error=typeof n=="function"?n:function(){};e.progress=typeof r=="function"?r:function(){};e.newDefer=new Deferred;return e.newDefer.promise}}};return e},simplyAjax=function(){function e(){var e;if(typeof XMLHttpRequest!="undefined")e=new XMLHttpRequest;else{var t=["Microsoft.XmlHttp","MSXML2.XmlHttp","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.5.0"];for(var n=0,r=t.length;n<r;n++)try{e=new ActiveXObject(t[n]);break}catch(i){}}return e}function t(e){var t=document.createElement("script");t.src=e;document.body.appendChild(t)}return{get:function(n){var r=new Deferred;if(n.dataType&&n.dataType.toLowerCase()=="jsonp"){var i=simplyAjax.utility.randomCallbackName();simplyAjax[i]=r.resolve;n.data.callback="simplyAjax."+i;var s=n.url+simplyAjax.utility.createQueryString(n.data);t(s)}else{var s=n.url+simplyAjax.utility.createQueryString(n.data),o=e();o.onreadystatechange=function(){o.readyState===4&&(o.status==200?r.resolve(o.responseText,o.status):r.reject(o.status))};o.open("GET",s,!0);o.send(null)}return r.promise},utility:{createQueryString:function(e){var t="",n=!1;for(var r in e){n&&(t+="&");t+=r+"="+e[r];n=!0}return"?"+t},random:function(){return Math.floor(Math.random()*1e10)},randomCallbackName:function(){var e=(new Date).getTime();return"simplyAjax_"+simplyAjax.utility.random()+"_"+e+"_"+simplyAjax.utility.random()}}}}(),hubJS=function(e){var t,n={version:0};return{userSettings:{},baseUrl:"http://api.hub.jhu.edu/",init:function(e){t=this;t.userSettings=t.utility.extend({},n,e)},get:function(n,r){var r=t.utility.extend({},r);r.v=t.userSettings.version;if(r.id){n=n+"/"+r.id;delete r.id}return e.get({url:t.baseUrl+n,dataType:"jsonp",data:r})},articles:{find:function(e){var e=t.utility.extend({},e);return t.get("articles",e)},recent:function(e){var n={per_page:t.utility.isNumeric(e)?e:5};return t.articles.find(n)},popular:function(e){var e=t.utility.extend({},e,{order_by:"score",score:"trending"});return t.get("articles",e)},related:function(e,n){var r=new Deferred,i=n&&n.excluded_ids?e+","+n.excluded_ids:e,n=t.utility.extend({},n,{excluded_ids:i}),s=t.articles.find({id:e}),o,u=s.then(function(e){o=e;var r=t.utility.extractEmbeddedItemIds(o,"tags"),i=t.utility.extend({},n,{tags:r.join(",")});return t.articles.find(i)}).then(function(e){if(e._embedded.articles)return e;var r=t.utility.extractEmbeddedItemIds(o,"topics"),i=t.utility.extend({},n,{topics:r.join(",")});return t.articles.find(i)}).then(function(e){r.resolve(e)});return r.promise}},utility:{extractEmbeddedItemIds:function(e,t){var n=e&&e._embedded&&e._embedded[t]||[];return n.map(function(e,t){return e.id})},extend:function(){for(var e=1,t=arguments.length;e<t;e++)for(var n in arguments[e])arguments[e].hasOwnProperty(n)&&(arguments[0][n]=arguments[e][n]);return arguments[0]},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}}}}(simplyAjax);